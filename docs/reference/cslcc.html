<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Level conditional coherent reconciliation for genuine hierarchical/grouped time series — cslcc • FoReco</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Level conditional coherent reconciliation for genuine hierarchical/grouped time series — cslcc"><meta name="description" content="This function implements the cross-sectional forecast reconciliation procedure that
extends the original proposal by Hollyman et al. (2021). Level conditional coherent
reconciled forecasts are conditional on (i.e., constrained by) the base forecasts
of a specific upper level in the hierarchy (exogenous constraints). It also allows
handling the linear constraints linking the variables endogenously (Di Fonzo and
Girolimetto, 2022). The function can calculate Combined Conditional Coherent (CCC)
forecasts as simple averages of Level-Conditional Coherent (LCC) and bottom-up
reconciled forecasts, with either endogenous or exogenous constraints."><meta property="og:description" content="This function implements the cross-sectional forecast reconciliation procedure that
extends the original proposal by Hollyman et al. (2021). Level conditional coherent
reconciled forecasts are conditional on (i.e., constrained by) the base forecasts
of a specific upper level in the hierarchy (exogenous constraints). It also allows
handling the linear constraints linking the variables endogenously (Di Fonzo and
Girolimetto, 2022). The function can calculate Combined Conditional Coherent (CCC)
forecasts as simple averages of Level-Conditional Coherent (LCC) and bottom-up
reconciled forecasts, with either endogenous or exogenous constraints."><meta property="og:image" content="https://danigiro.github.io/FoReco/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FoReco</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0.9013</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-question-circle"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/Dataset-vndata-and-itagdp.html">The `vndata` and `itagdp` dataset</a></li>
    <li><a class="dropdown-item" href="../articles/Cross-sectional-forecast-reconciliation.html">Cross-sectional forecast reconciliation</a></li>
    <li><a class="dropdown-item" href="../articles/Temporal-forecast-reconciliation.html">Temporal forecast reconciliation</a></li>
    <li><a class="dropdown-item" href="../articles/Cross-temporal-forecast-reconciliation.html">Cross-temporal forecast reconciliation</a></li>
    <li><a class="dropdown-item" href="../articles/Replicate-the-hts-package.html">Replicate the `hts` package</a></li>
    <li><a class="dropdown-item" href="../articles/Replicate-the-thief-package.html">Replicate the `thief` package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa far fa-newspaper"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/danigiro/FoReco" aria-label="View on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cran.r-project.org/web/packages/FoReco/index.html" aria-label="View on CRAN"><span class="fa fab fa-r-project fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Level conditional coherent reconciliation for genuine hierarchical/grouped time series</h1>
      <small class="dont-index">Source: <a href="https://github.com/danigiro/FoReco/blob/HEAD/R/reco_lcc.R" class="external-link"><code>R/reco_lcc.R</code></a></small>
      <div class="d-none name"><code>cslcc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the cross-sectional forecast reconciliation procedure that
extends the original proposal by Hollyman et al. (2021). Level conditional coherent
reconciled forecasts are conditional on (i.e., constrained by) the base forecasts
of a specific upper level in the hierarchy (exogenous constraints). It also allows
handling the linear constraints linking the variables endogenously (Di Fonzo and
Girolimetto, 2022). The function can calculate Combined Conditional Coherent (CCC)
forecasts as simple averages of Level-Conditional Coherent (LCC) and bottom-up
reconciled forecasts, with either endogenous or exogenous constraints.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cslcc</span><span class="op">(</span><span class="va">base</span>, <span class="va">agg_mat</span>, nodes <span class="op">=</span> <span class="st">"auto"</span>, comb <span class="op">=</span> <span class="st">"ols"</span>, res <span class="op">=</span> <span class="cn">NULL</span>, CCC <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      const <span class="op">=</span> <span class="st">"exogenous"</span>, bts <span class="op">=</span> <span class="cn">NULL</span>, approach <span class="op">=</span> <span class="st">"proj"</span>, nn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      settings <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-base">base<a class="anchor" aria-label="anchor" href="#arg-base"></a></dt>
<dd><p>A (\(h \times n\)) numeric matrix or multivariate time series
(<code>mts</code> class) containing the base forecasts to be reconciled; \(h\)
is the forecast horizon, and \(n\) is the total number of time series
(\(n = n_a + n_b\)).</p></dd>


<dt id="arg-agg-mat">agg_mat<a class="anchor" aria-label="anchor" href="#arg-agg-mat"></a></dt>
<dd><p>A (\(n_a \times n_b\)) numeric matrix representing the
cross-sectional aggregation matrix. It maps the \(n_b\) bottom-level
(free) variables into the \(n_a\) upper (constrained) variables.</p></dd>


<dt id="arg-nodes">nodes<a class="anchor" aria-label="anchor" href="#arg-nodes"></a></dt>
<dd><p>A (\(L \times 1\)) numeric vector indicating the number of variables
in each of the upper \(L\) levels of the hierarchy. The <em>default</em>
value is the string "<code>auto</code>" which calculates the number of variables in each level.</p></dd>


<dt id="arg-comb">comb<a class="anchor" aria-label="anchor" href="#arg-comb"></a></dt>
<dd><p>A string specifying the reconciliation method. For a complete
list, see <a href="cscov.html">cscov</a>.</p></dd>


<dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>An (\(N \times n\)) optional numeric matrix containing the
in-sample residuals or validation errors. This matrix is used to compute
some covariance matrices.</p></dd>


<dt id="arg-ccc">CCC<a class="anchor" aria-label="anchor" href="#arg-ccc"></a></dt>
<dd><p>A logical value indicating whether the Combined Conditional Coherent reconciled
forecasts reconciliation should include bottom-up forecasts (<code>TRUE</code>, <em>default</em>), or not.</p></dd>


<dt id="arg-const">const<a class="anchor" aria-label="anchor" href="#arg-const"></a></dt>
<dd><p>A string specifying the reconciliation constraints:</p><ul><li><p>"<code>exogenous</code>" (<em>default</em>): Fixes the top level of each sub-hierarchy.</p></li>
<li><p>"<code>endogenous</code>": Coherently revises both the top and bottom levels.</p></li>
</ul></dd>


<dt id="arg-bts">bts<a class="anchor" aria-label="anchor" href="#arg-bts"></a></dt>
<dd><p>A (\(h \times n_b\)) numeric matrix or multivariate time series (<code>mts</code> class)
containing bottom base forecasts defined by the user (e.g., seasonal averages, as in Hollyman et al., 2021).
This parameter can be omitted if only base forecasts are used
(see Di Fonzo and Girolimetto, 2024).</p></dd>


<dt id="arg-approach">approach<a class="anchor" aria-label="anchor" href="#arg-approach"></a></dt>
<dd><p>A string specifying the approach used to compute the
reconciled forecasts. Options include:</p><ul><li><p>"<code>proj</code>" (<em>default</em>): Projection approach according
to Byron (1978, 1979).</p></li>
<li><p>"<code>strc</code>": Structural approach as proposed by Hyndman
et al. (2011).</p></li>
<li><p>"<code>proj_osqp</code>": Numerical solution using
<a href="https://osqp.org/" class="external-link"><span class="pkg">osqp</span></a> for projection approach.</p></li>
<li><p>"<code>strc_osqp</code>": Numerical solution using
<a href="https://osqp.org/" class="external-link"><span class="pkg">osqp</span></a> for structural approach.</p></li>
</ul></dd>


<dt id="arg-nn">nn<a class="anchor" aria-label="anchor" href="#arg-nn"></a></dt>
<dd><p>A string specifying the algorithm to compute non-negative
forecasts:</p><ul><li><p>"<code>osqp</code>": quadratic programming optimization
(<a href="https://osqp.org/" class="external-link"><span class="pkg">osqp</span></a> solver).</p></li>
<li><p>"<code>bpv</code>": block principal pivoting algorithm
(Wickramasuriya et al., 2020).</p></li>
<li><p>"<code>nfca</code>": negative forecasts correction algorithm
(Kourentzes and Athanasopoulos, 2021; Girolimetto 2025).</p></li>
<li><p>"<code>nnic</code>": iterative non-negative reconciliation with immutable
constraints (Girolimetto 2025).</p></li>
<li><p>"<code>sntz</code>": heuristic "set-negative-to-zero"
(Di Fonzo and Girolimetto, 2023; Girolimetto 2025).</p></li>
</ul></dd>


<dt id="arg-settings">settings<a class="anchor" aria-label="anchor" href="#arg-settings"></a></dt>
<dd><p>A list of control parameters.</p><ul><li><p><code>nn = "osqp"</code> An object of class <code>osqpSettings</code> specifying
settings for the <a href="https://osqp.org/" class="external-link"><span class="pkg">osqp</span></a> solver. For details,
refer to the <a href="https://osqp.org/" class="external-link"><span class="pkg">osqp</span> documentation</a>
(Stellato et al., 2020)</p></li>
<li><p><code>nn = "bpv"</code></p><ul><li><p><code>ptype = "fixed"</code>: permutation method: "<code>random</code>" or
"<code>fixed</code>"</p></li>
<li><p><code>par = 10</code>: the number of full exchange rules that may be
attempted</p></li>
<li><p><code>tol = sqrt(.Machine$double.eps)</code>: the tolerance criteria</p></li>
<li><p><code>gtol = sqrt(.Machine$double.eps)</code>: the gradient tolerance
criteria</p></li>
<li><p><code>itmax = 100</code>: the maximum number of algorithm iterations</p></li>
</ul></li>
<li><p><code>nn = "nfca"</code> and <code>nn = "nnic"</code></p><ul><li><p><code>tol = sqrt(.Machine$double.eps)</code>: the tolerance criteria</p></li>
<li><p><code>itmax = 100</code>: the maximum number of algorithm iterations</p></li>
</ul></li>
<li><p><code>nn = "sntz"</code></p><ul><li><p><code>type = "bu"</code>: the type of set-negative-to-zero heuristic:
"<code>bu</code>" for bottom-up, "<code>tdp</code>" for top-down
proportional, "<code>tdsp</code>" for top-down square proportional,
"<code>tdvw</code>" for top-down variance weighted (the <code>res</code> param is
used). See Girolimetto (2025) for details.</p></li>
<li><p><code>tol = sqrt(.Machine$double.eps)</code>: the tolerance
identification of negative values</p></li>
</ul></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="cscov.html">cscov</a></code></p><dl><dt><code>mse</code></dt>
<dd><p>If <code>TRUE</code> (<em>default</em>) the errors used to compute the
covariance matrix are not mean-corrected.</p></dd>

    <dt><code>shrink_fun</code></dt>
<dd><p>Shrinkage function of the covariance matrix,
<a href="shrink_estim.html">shrink_estim</a> (<em>default</em>).</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A (\(h \times n\)) numeric matrix of cross-sectional
reconciled forecasts.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Byron, R.P. (1978), The estimation of large social account matrices,
<em>Journal of the Royal Statistical Society, Series A</em>, 141, 3, 359-367.
<a href="https://doi.org/10.2307/2344807" class="external-link">doi:10.2307/2344807</a></p>
<p>Byron, R.P. (1979), Corrigenda: The estimation of large social account matrices,
<em>Journal of the Royal Statistical Society, Series A</em>, 142(3), 405.
<a href="https://doi.org/10.2307/2982515" class="external-link">doi:10.2307/2982515</a></p>
<p>Di Fonzo, T. and Girolimetto, D. (2024), Forecast combination-based forecast reconciliation:
Insights and extensions, <em>International Journal of Forecasting</em>, 40(2), 490–514.
<a href="https://doi.org/10.1016/j.ijforecast.2022.07.001" class="external-link">doi:10.1016/j.ijforecast.2022.07.001</a></p>
<p>Di Fonzo, T. and Girolimetto, D. (2023b) Spatio-temporal reconciliation of solar forecasts.
<em>Solar Energy</em> 251, 13–29. <a href="https://doi.org/10.1016/j.solener.2023.01.003" class="external-link">doi:10.1016/j.solener.2023.01.003</a></p>
<p>Girolimetto, D. (2025), Non-negative forecast reconciliation: Optimal
methods and operational solutions. <em>mimeo</em></p>
<p>Hyndman, R.J., Ahmed, R.A., Athanasopoulos, G. and Shang, H.L. (2011),
Optimal combination forecasts for hierarchical time series,
<em>Computational Statistics &amp; Data Analysis</em>, 55, 9, 2579-2589.
<a href="https://doi.org/10.1016/j.csda.2011.03.006" class="external-link">doi:10.1016/j.csda.2011.03.006</a></p>
<p>Kourentzes, N. and Athanasopoulos, G. (2021) Elucidate structure in
intermittent demand series. <em>European Journal of Operational Research</em>,
288, 141-152. <a href="https://doi.org/10.1016/j.ejor.2020.05.046" class="external-link">doi:10.1016/j.ejor.2020.05.046</a></p>
<p>Hollyman, R., Petropoulos, F. and Tipping, M.E. (2021), Understanding forecast reconciliation.
<em>European Journal of Operational Research</em>, 294, 149–160. <a href="https://doi.org/10.1016/j.ejor.2021.01.017" class="external-link">doi:10.1016/j.ejor.2021.01.017</a></p>
<p>Stellato, B., Banjac, G., Goulart, P., Bemporad, A. and Boyd, S. (2020), OSQP:
An Operator Splitting solver for Quadratic Programs,
<em>Mathematical Programming Computation</em>, 12, 4, 637-672.
<a href="https://doi.org/10.1007/s12532-020-00179-2" class="external-link">doi:10.1007/s12532-020-00179-2</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Level conditional coherent reconciliation:
<code><a href="ctlcc.html">ctlcc</a>()</code>,
<code><a href="telcc.html">telcc</a>()</code></p>
<p>Cross-sectional framework:
<code><a href="csboot.html">csboot</a>()</code>,
<code><a href="csbu.html">csbu</a>()</code>,
<code><a href="cscov.html">cscov</a>()</code>,
<code><a href="csmo.html">csmo</a>()</code>,
<code><a href="csmvn.html">csmvn</a>()</code>,
<code><a href="csrec.html">csrec</a>()</code>,
<code><a href="cssmp.html">cssmp</a>()</code>,
<code><a href="cstd.html">cstd</a>()</code>,
<code><a href="cstools.html">cstools</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Aggregation matrix for Z = X + Y, X = XX + XY and Y = YX + YY</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># (2 x 7) base forecasts matrix (simulated)</span></span></span>
<span class="r-in"><span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">7</span><span class="op">*</span><span class="fl">2</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># (10 x 7) in-sample residuals matrix (simulated)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># (2 x 7) Naive bottom base forecasts matrix: all forecasts are set equal to 10</span></span></span>
<span class="r-in"><span><span class="va">naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## EXOGENOUS CONSTRAINTS (Hollyman et al., 2021)</span></span></span>
<span class="r-in"><span><span class="co"># Level Conditional Coherent (LCC) reconciled forecasts</span></span></span>
<span class="r-in"><span><span class="va">exo_LC</span> <span class="op">&lt;-</span> <span class="fu">cslcc</span><span class="op">(</span>base <span class="op">=</span> <span class="va">base</span>, agg_mat <span class="op">=</span> <span class="va">A</span>, comb <span class="op">=</span> <span class="st">"wls"</span>, bts <span class="op">=</span> <span class="va">naive</span>,</span></span>
<span class="r-in"><span>                res <span class="op">=</span> <span class="va">res</span>, nodes <span class="op">=</span> <span class="st">"auto"</span>, CCC <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combined Conditional Coherent (CCC) reconciled forecasts</span></span></span>
<span class="r-in"><span><span class="va">exo_CCC</span> <span class="op">&lt;-</span> <span class="fu">cslcc</span><span class="op">(</span>base <span class="op">=</span> <span class="va">base</span>, agg_mat <span class="op">=</span> <span class="va">A</span>, comb <span class="op">=</span> <span class="st">"wls"</span>, bts <span class="op">=</span> <span class="va">naive</span>,</span></span>
<span class="r-in"><span>                 res <span class="op">=</span> <span class="va">res</span>, nodes <span class="op">=</span> <span class="st">"auto"</span>, CCC <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Results detailed by level:</span></span></span>
<span class="r-in"><span><span class="co"># L-1: Level 1 immutable reconciled forecasts for the whole hierarchy</span></span></span>
<span class="r-in"><span><span class="co"># L-2: Middle-Out reconciled forecasts</span></span></span>
<span class="r-in"><span><span class="co"># L-3: Bottom-Up reconciled forecasts</span></span></span>
<span class="r-in"><span><span class="va">info_exo</span> <span class="op">&lt;-</span> <span class="fu"><a href="recoinfo.html">recoinfo</a></span><span class="op">(</span><span class="va">exo_CCC</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">info_exo</span><span class="op">$</span><span class="va">lcc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`L-1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s-1      s-2      s-3      s-4      s-5      s-6      s-7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-1 39.43952 19.76757 19.67196 9.893588 9.873979 9.744387 9.927570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-2 38.73494 19.47537 19.25957 9.759815 9.715556 9.423051 9.836517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"FoReco")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`L-2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s-1      s-2      s-3      s-4      s-5       s-6       s-7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-1 41.32853 19.76982 21.55871 9.894620 9.875202 11.214555 10.344153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-2 38.86749 19.31315 19.55434 9.685546 9.627601  9.652737  9.901601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"FoReco")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`L-3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s-1     s-2      s-3      s-4      s-5      s-6      s-7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-1 42.37578 20.1998 22.17598 10.07051 10.12929 11.71506 10.46092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-2 42.09535 21.5839 20.51145 11.22408 10.35981 10.40077 10.11068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"FoReco")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ENDOGENOUS CONSTRAINTS (Di Fonzo and Girolimetto, 2024)</span></span></span>
<span class="r-in"><span><span class="co"># Level Conditional Coherent (LCC) reconciled forecasts</span></span></span>
<span class="r-in"><span><span class="va">endo_LC</span> <span class="op">&lt;-</span> <span class="fu">cslcc</span><span class="op">(</span>base <span class="op">=</span> <span class="va">base</span>, agg_mat <span class="op">=</span> <span class="va">A</span>, comb <span class="op">=</span> <span class="st">"wls"</span>,</span></span>
<span class="r-in"><span>                 res <span class="op">=</span> <span class="va">res</span>, nodes <span class="op">=</span> <span class="st">"auto"</span>, CCC <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                 const <span class="op">=</span> <span class="st">"endogenous"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combined Conditional Coherent (CCC) reconciled forecasts</span></span></span>
<span class="r-in"><span><span class="va">endo_CCC</span> <span class="op">&lt;-</span> <span class="fu">cslcc</span><span class="op">(</span>base <span class="op">=</span> <span class="va">base</span>, agg_mat <span class="op">=</span> <span class="va">A</span>, comb <span class="op">=</span> <span class="st">"wls"</span>,</span></span>
<span class="r-in"><span>                  res <span class="op">=</span> <span class="va">res</span>, nodes <span class="op">=</span> <span class="st">"auto"</span>, CCC <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                  const <span class="op">=</span> <span class="st">"endogenous"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Results detailed by level:</span></span></span>
<span class="r-in"><span><span class="co"># L-1: Level 1 reconciled forecasts for L1 + L3 (bottom level)</span></span></span>
<span class="r-in"><span><span class="co"># L-2: Level 2 reconciled forecasts for L2 + L3 (bottom level)</span></span></span>
<span class="r-in"><span><span class="co"># L-3: Bottom-Up reconciled forecasts</span></span></span>
<span class="r-in"><span><span class="va">info_endo</span> <span class="op">&lt;-</span> <span class="fu"><a href="recoinfo.html">recoinfo</a></span><span class="op">(</span><span class="va">endo_CCC</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">info_endo</span><span class="op">$</span><span class="va">lcc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`L-1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s-1      s-2      s-3       s-4      s-5       s-6       s-7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-1 40.23685 19.31277 20.92408  9.664411 9.648359 10.739579 10.184505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-2 39.64745 20.56873 19.07871 10.759321 9.809413  9.284371  9.794343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"FoReco")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`L-2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s-1      s-2      s-3       s-4      s-5       s-6       s-7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-1 41.70862 19.94714 21.76149  9.954836 9.992300 11.392087 10.369398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-2 40.11832 20.24956 19.86876 10.613199 9.636364  9.899977  9.968779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"FoReco")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`L-3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s-1     s-2      s-3      s-4      s-5      s-6      s-7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-1 42.37578 20.1998 22.17598 10.07051 10.12929 11.71506 10.46092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h-2 42.09535 21.5839 20.51145 11.22408 10.35981 10.40077 10.11068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"FoReco")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniele Girolimetto, Tommaso Di Fonzo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

