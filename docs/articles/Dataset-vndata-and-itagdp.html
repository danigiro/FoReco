<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="FoReco">
<title>The vndata and itagdp dataset • FoReco</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The vndata and itagdp dataset">
<meta property="og:description" content="FoReco">
<meta property="og:image" content="https://danigiro.github.io/FoReco/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FoReco</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0.9013</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--vignettes">
    <span class="fa fa-question-circle"></span>
     
    Vignettes
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--vignettes">
    <a class="dropdown-item" href="../articles/Dataset-vndata-and-itagdp.html">The `vndata` and `itagdp` dataset</a>
    <a class="dropdown-item" href="../articles/Cross-sectional-forecast-reconciliation.html">Cross-sectional forecast reconciliation</a>
    <a class="dropdown-item" href="../articles/Temporal-forecast-reconciliation.html">Temporal forecast reconciliation</a>
    <a class="dropdown-item" href="../articles/Cross-temporal-forecast-reconciliation.html">Cross-temporal forecast reconciliation</a>
    <a class="dropdown-item" href="../articles/Replicate-the-hts-package.html">Replicate the `hts` package</a>
    <a class="dropdown-item" href="../articles/Replicate-the-thief-package.html">Replicate the `thief` package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="far fa far fa-newspaper"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danigiro/FoReco">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://cran.r-project.org/web/packages/FoReco/index.html">
    <span class="fab fa fab fa-r-project fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>The vndata and itagdp dataset</h1>
                        <h4 data-toc-skip class="author">Daniele
Girolimetto</h4>
            
            <h4 data-toc-skip class="date">2025-05-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/danigiro/FoReco/blob/HEAD/vignettes/articles/Dataset-vndata-and-itagdp.qmd" class="external-link"><code>vignettes/articles/Dataset-vndata-and-itagdp.qmd</code></a></small>
      <div class="d-none name"><code>Dataset-vndata-and-itagdp.qmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Load the packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danigiro/FoReco" class="external-link">FoReco</a></span><span class="op">)</span> <span class="co"># the datasets</span></span>
<span></span>
<span><span class="co"># Plot and analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/" class="external-link">forecast</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="vndata-groupped-monthly-time-series">
<code>vndata</code>: Groupped monthly time series<a class="anchor" aria-label="anchor" href="#vndata-groupped-monthly-time-series"></a>
</h2>
<div class="figure" style="text-align: center">
<img src="images/infoVN.png" alt="Australian Tourism Demand cross-sectional and temporal structure" width="75%"><p class="caption">
Australian Tourism Demand cross-sectional and temporal structure
</p>
</div>
<p>The Australian Tourism Demand dataset <span class="citation">(Girolimetto et al., 2024; Wickramasuriya et al.,
2018)</span> measures the number of nights Australians spent away from
home. It includes 228 monthly observations of Visitor Nights (VNs) from
January 1998 to December 2016, and has a cross-sectional grouped
structure based on a geographic hierarchy crossed by purpose of travel.
The monthly bottom times series are available at <a href="https://robjhyndman.com/data/TourismData_v3.csv" class="external-link">robjhyndman.com/data/TourismData_v3.csv</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Time-Series [1:228, 1:525] from 1998 to 2017: 45151 17295 20725 25389 20330 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:525] "Total" "A" "B" "C" ...</span></span>
<span></span>
<span><span class="co"># Aggregation matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vnaggmat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">vnaggmat</span><span class="op">)</span></span>
<span><span class="co">#&gt;  int [1:221, 1:304] 1 1 0 0 0 0 0 0 1 0 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:221] "Total" "A" "B" "C" ...</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:304] "AAAHol" "AAAVis" "AAABus" "AAAOth" ...</span></span>
<span></span>
<span><span class="va">id_bts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">vnaggmat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NCOL</a></span><span class="op">(</span><span class="va">vnaggmat</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSW"</span>, <span class="st">"VIC"</span>, <span class="st">"QLD"</span>, <span class="st">"SA"</span>, <span class="st">"WA"</span>, <span class="st">"TAS"</span>, <span class="st">"NT"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">states</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">marrangeGrob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">[</span>,<span class="st">"Total"</span><span class="op">]</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"Australia (total)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">[</span>, <span class="va">states</span><span class="op">]</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"States"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hol"</span>, <span class="st">"Vis"</span>, <span class="st">"Bus"</span>, <span class="st">"Oth"</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"Purpose of travel"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">[</span>,<span class="va">id_bts</span><span class="op">]</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"Bottom time series"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             top <span class="op">=</span> <span class="cn">NULL</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dataset-vndata-and-itagdp_files/figure-html/data-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The geographic hierarchy comprises 7 states, 27 zones, and 76
regions, for a total of 111 nested geographic divisions. Six of these
zones are each formed by a single region, resulting in 105 unique nodes
in the hierarchy. The purpose of travel comprises four categories:
holiday, visiting friends and relatives, business, and other. To avoid
redundancies <span class="citation">(Di Fonzo &amp; Girolimetto,
2024)</span>, 24 nodes (6 zones are formed by a single region) are not
considered, resulting in an unbalanced hierarchy of 525 unique nodes
instead of the theoretical 555 with duplicated nodes. The data can be
temporally aggregated into two, three, four, six, or twelve months
(<span class="math inline">\(\mathcal{K}=\{12, 6, 4, 3, 2,
1\}\)</span>).</p>
<div class="figure" style="text-align: center">
<img src="images/bal_unb.png" alt="A simple unbalanced hierarchy (left) and its balanced version (right). Source: @DiFonzo2024-ijf." width="60%"><p class="caption">
A simple unbalanced hierarchy (left) and its balanced version (right).
Source: <span class="citation">Di Fonzo &amp; Girolimetto (2024)</span>.
</p>
</div>
</div>
<div class="section level2">
<h2 id="itagdp-general-linearly-constrained-multiple-quarterly-time-series">
<code>itagdp</code>: general linearly constrained multiple quarterly
time series<a class="anchor" aria-label="anchor" href="#itagdp-general-linearly-constrained-multiple-quarterly-time-series"></a>
</h2>
<p>The National Accounts are a coherent and consistent set of
macroeconomic indicators that are used mostly for economic research and
forecasting, policy design, and coordination mechanisms. In this
dataset, GDP is a key macroeconomic quantity that is measured using
three main approaches, namely output (or production), income and
expenditure. These parallel systems internally present a well-defned
hierarchical structure of variables with relevant economic signifcance,
such as Final consumption, on the expenditure side, Gross operating
surplus and mixed income on the income side, and Total gross value added
on the output side. In the EU countries, the data is processed on the
basis of the ESA 2010 classifcation and are released by Eurostat. The
dataset <code>itagdp</code> (<a href="https://ec.europa.eu/eurostat/web/national-accounts/" class="external-link">https://ec.europa.eu/eurostat/web/national-accounts/</a>)
contains the Italian Gross Domestic Product (GDP) at at current prices
(in euro), with time series spanning the period 2000:Q1-2019:Q4.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">itagdp</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">itagdp</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Time-Series [1:80, 1:21] from 2000 to 2020: 290847 309761 301049 339856 307934 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:21] "GDP" "D1" "P3_P5" "P3" ...</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">itagdp</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dataset-vndata-and-itagdp_files/figure-html/itagdp-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The output, income and expenditure approaches are represented as
three differente hierarchies that share the same top-level series (<span class="math inline">\(GDP\)</span>), but not the bottom-level
series.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_mat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mat</span>, <span class="va">font_size</span> <span class="op">=</span> <span class="fl">8</span>, <span class="va">caption_label</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Var2</span>, y <span class="op">=</span> <span class="va">Var1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-1"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="st">"white"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="cn">NULL</span>, y<span class="op">=</span><span class="cn">NULL</span>, title<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>limits<span class="op">=</span><span class="va">rev</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="va">caption_label</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">font_size</span>, vjust<span class="op">=</span><span class="fl">0.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, hjust<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>          axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">font_size</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>          plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>, hjust<span class="op">=</span><span class="fl">0.5</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">marrangeGrob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">plot_mat</span><span class="op">(</span><span class="va">incside</span><span class="op">$</span><span class="va">agg_mat</span>, caption_label <span class="op">=</span> <span class="st">"Income hierarchy"</span><span class="op">)</span>,</span>
<span>                  <span class="fu">plot_mat</span><span class="op">(</span><span class="va">outside</span><span class="op">$</span><span class="va">agg_mat</span>, caption_label <span class="op">=</span> <span class="st">"Output hierarchy"</span><span class="op">)</span>, </span>
<span>                  <span class="fu">plot_mat</span><span class="op">(</span><span class="va">expside</span><span class="op">$</span><span class="va">agg_mat</span>, caption_label <span class="op">=</span> <span class="st">"Expenditure hierarchy"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             top <span class="op">=</span> <span class="cn">NULL</span>, layout_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dataset-vndata-and-itagdp_files/figure-html/plot-itagdp-1.png" width="50%" style="display: block; margin: auto;"></p>
<p>The complete <span class="math inline">\((9 \times 21)\)</span> zero
constraints matrix encompassing output, expenditure and income sides is
represented in the following figure.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GDP[O]"</span>, <span class="st">"GDP[I]"</span>, <span class="st">"GDP[E]"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span> </span>
<span><span class="fu">plot_mat</span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dataset-vndata-and-itagdp_files/figure-html/gdpconsmat-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>A linear combination matrix for a general linearly constrained
multiple time series may be construct <span class="citation">(Girolimetto &amp; Di Fonzo, 2023)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmat.html">lcmat</a></span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span> </span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">obj</span><span class="op">$</span><span class="va">agg_mat</span></span>
<span><span class="fu">plot_mat</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>, caption_label <span class="op">=</span> <span class="st">"Income, Output and Expenditure linear combination matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dataset-vndata-and-itagdp_files/figure-html/lcmat-gdp-1.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-DiFonzo2024-ijf" class="csl-entry">
Di Fonzo, T., &amp; Girolimetto, D. (2024). Forecast combination-based
forecast reconciliation: Insights and extensions. <em>International
Journal of Forecasting</em>, <em>40</em>(2), 490–514. <a href="https://doi.org/10.1016/j.ijforecast.2022.07.001" class="external-link">https://doi.org/10.1016/j.ijforecast.2022.07.001</a>
</div>
<div id="ref-Girolimetto2023-jm" class="csl-entry">
Girolimetto, D., Athanasopoulos, G., Di Fonzo, T., &amp; Hyndman, R. J.
(2024). Cross-temporal probabilistic forecast reconciliation:
Methodological and practical issues. <em>International Journal of
Forecasting</em>, <em>40</em>(3), 1134–1151. <a href="https://doi.org/10.1016/j.ijforecast.2023.10.003" class="external-link">https://doi.org/10.1016/j.ijforecast.2023.10.003</a>
</div>
<div id="ref-Girolimetto2023-ft" class="csl-entry">
Girolimetto, D., &amp; Di Fonzo, T. (2023). Point and probabilistic
forecast reconciliation for general linearly constrained multiple time
series. <em>Statistical Methods &amp; Applications</em>. <a href="https://doi.org/10.1007/s10260-023-00738-6" class="external-link">https://doi.org/10.1007/s10260-023-00738-6</a>
</div>
<div id="ref-Wickramasuriya2019" class="csl-entry">
Wickramasuriya, S. L., Athanasopoulos, G., &amp; Hyndman, R. J. (2018).
Optimal Forecast Reconciliation for Hierarchical and Grouped Time Series
Through Trace Minimization. <em>Journal of the American Statistical
Association</em>, <em>114</em>(526), 804–819. <a href="https://doi.org/10.1080/01621459.2018.1448825" class="external-link">https://doi.org/10.1080/01621459.2018.1448825</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniele Girolimetto, Tommaso Di Fonzo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
