<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The vndata and itagdp dataset • FoReco</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="Dataset-vndata-and-itagdp_files/libs/quarto-html/popper.min.js"></script><script src="Dataset-vndata-and-itagdp_files/libs/quarto-html/tippy.umd.min.js"></script><link href="Dataset-vndata-and-itagdp_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Dataset-vndata-and-itagdp_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The vndata and itagdp dataset">
<meta property="og:image" content="https://danigiro.github.io/FoReco/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FoReco</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0.9013</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book"></span> Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-question-circle"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/Dataset-vndata-and-itagdp.html">The `vndata` and `itagdp` dataset</a></li>
    <li><a class="dropdown-item" href="../articles/Cross-sectional-forecast-reconciliation.html">Cross-sectional forecast reconciliation</a></li>
    <li><a class="dropdown-item" href="../articles/Temporal-forecast-reconciliation.html">Temporal forecast reconciliation</a></li>
    <li><a class="dropdown-item" href="../articles/Cross-temporal-forecast-reconciliation.html">Cross-temporal forecast reconciliation</a></li>
    <li><a class="dropdown-item" href="../articles/Replicate-the-hts-package.html">Replicate the `hts` package</a></li>
    <li><a class="dropdown-item" href="../articles/Replicate-the-thief-package.html">Replicate the `thief` package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa far fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danigiro/FoReco" aria-label="View on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cran.r-project.org/web/packages/FoReco/index.html" aria-label="View on CRAN"><span class="fa fab fa-r-project fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>The vndata and itagdp dataset</h1>

      <p class="author">Daniele Girolimetto</p>
      <p class="date">2025-10-23</p>

      <small class="dont-index">Source: <a href="https://github.com/danigiro/FoReco/blob/HEAD/vignettes/articles/Dataset-vndata-and-itagdp.qmd" class="external-link"><code>vignettes/articles/Dataset-vndata-and-itagdp.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Load the packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danigiro/FoReco" class="external-link">FoReco</a></span><span class="op">)</span> <span class="co"># the datasets</span></span>
<span></span>
<span><span class="co"># Plot and analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/" class="external-link">forecast</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="vndata-groupped-monthly-time-series">
<code>vndata</code>: Groupped monthly time series<a class="anchor" aria-label="anchor" href="#vndata-groupped-monthly-time-series"></a>
</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="https://raw.githubusercontent.com/danigiro/FoReco/refs/heads/master/vignettes/articles/images/infoVN.png" style="width:75.0%"></p>
<figcaption>Australian Tourism Demand cross-sectional and temporal structure</figcaption></figure>
</div>
</div>
</div>
<p>The Australian Tourism Demand dataset <span class="citation" data-cites="Wickramasuriya2019 Girolimetto2023-jm">(<a href="#ref-Girolimetto2023-jm" role="doc-biblioref">Girolimetto et al., 2024</a>; <a href="#ref-Wickramasuriya2019" role="doc-biblioref">Wickramasuriya et al., 2018</a>)</span> measures the number of nights Australians spent away from home. It includes 228 monthly observations of Visitor Nights (VNs) from January 1998 to December 2016, and has a cross-sectional grouped structure based on a geographic hierarchy crossed by purpose of travel. The monthly bottom times series are available at <a href="https://robjhyndman.com/data/TourismData_v3.csv" class="external-link">robjhyndman.com/data/TourismData_v3.csv</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Time-Series [1:228, 1:525] from 1998 to 2017: 45151 17295 20725 25389 20330 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:525] "Total" "A" "B" "C" ...</span></span>
<span></span>
<span><span class="co"># Aggregation matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vnaggmat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">vnaggmat</span><span class="op">)</span></span>
<span><span class="co">#&gt;  int [1:221, 1:304] 1 1 0 0 0 0 0 0 1 0 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:221] "Total" "A" "B" "C" ...</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:304] "AAAHol" "AAAVis" "AAABus" "AAAOth" ...</span></span>
<span></span>
<span><span class="va">id_bts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">vnaggmat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NCOL</a></span><span class="op">(</span><span class="va">vnaggmat</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSW"</span>, <span class="st">"VIC"</span>, <span class="st">"QLD"</span>, <span class="st">"SA"</span>, <span class="st">"WA"</span>, <span class="st">"TAS"</span>, <span class="st">"NT"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">states</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">marrangeGrob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">[</span>,<span class="st">"Total"</span><span class="op">]</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"Australia (total)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">[</span>, <span class="va">states</span><span class="op">]</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"States"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hol"</span>, <span class="st">"Vis"</span>, <span class="st">"Bus"</span>, <span class="st">"Oth"</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"Purpose of travel"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">vndata</span><span class="op">[</span>,<span class="va">id_bts</span><span class="op">]</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"Bottom time series"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             top <span class="op">=</span> <span class="cn">NULL</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Dataset-vndata-and-itagdp_files/figure-html/data-1.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>The geographic hierarchy comprises 7 states, 27 zones, and 76 regions, for a total of 111 nested geographic divisions. Six of these zones are each formed by a single region, resulting in 105 unique nodes in the hierarchy. The purpose of travel comprises four categories: holiday, visiting friends and relatives, business, and other. To avoid redundancies <span class="citation" data-cites="DiFonzo2024-ijf">(<a href="#ref-DiFonzo2024-ijf" role="doc-biblioref">Di Fonzo &amp; Girolimetto, 2024</a>)</span>, 24 nodes (6 zones are formed by a single region) are not considered, resulting in an unbalanced hierarchy of 525 unique nodes instead of the theoretical 555 with duplicated nodes. The data can be temporally aggregated into two, three, four, six, or twelve months (<span class="math inline">\(\mathcal{K}=\{12, 6, 4, 3, 2, 1\}\)</span>).</p>
<div class="cell" data-layout-align="center" data-fig.margin="true">
<div class="cell-output-display">
<div id="fig-balh" class="quarto-float quarto-figure quarto-figure-center" data-fig-align="center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-balh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://raw.githubusercontent.com/danigiro/FoReco/refs/heads/master/vignettes/articles/images/bal_unb.png" class="quarto-figure quarto-figure-center" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-balh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 1: A simple unbalanced hierarchy (left) and its balanced version (right). Source: <span class="citation" data-cites="DiFonzo2024-ijf">Di Fonzo &amp; Girolimetto (<a href="#ref-DiFonzo2024-ijf" role="doc-biblioref">2024</a>)</span>.
</figcaption></figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="itagdp-general-linearly-constrained-multiple-quarterly-time-series">
<code>itagdp</code>: general linearly constrained multiple quarterly time series<a class="anchor" aria-label="anchor" href="#itagdp-general-linearly-constrained-multiple-quarterly-time-series"></a>
</h2>
<p>The National Accounts are a coherent and consistent set of macroeconomic indicators that are used mostly for economic research and forecasting, policy design, and coordination mechanisms. In this dataset, GDP is a key macroeconomic quantity that is measured using three main approaches, namely output (or production), income and expenditure. These parallel systems internally present a well-defned hierarchical structure of variables with relevant economic signifcance, such as Final consumption, on the expenditure side, Gross operating surplus and mixed income on the income side, and Total gross value added on the output side. In the EU countries, the data is processed on the basis of the ESA 2010 classifcation and are released by Eurostat. The dataset <code>itagdp</code> (<a href="https://ec.europa.eu/eurostat/web/national-accounts/" class="external-link">https://ec.europa.eu/eurostat/web/national-accounts/</a>) contains the Italian Gross Domestic Product (GDP) at at current prices (in euro), with time series spanning the period 2000:Q1-2019:Q4.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">itagdp</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">itagdp</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Time-Series [1:80, 1:21] from 2000 to 2020: 290847 309761 301049 339856 307934 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:21] "GDP" "D1" "P3_P5" "P3" ...</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">itagdp</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Dataset-vndata-and-itagdp_files/figure-html/itagdp-1.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>The output, income and expenditure approaches are represented as three differente hierarchies that share the same top-level series (<span class="math inline">\(GDP\)</span>), but not the bottom-level series.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_mat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mat</span>, <span class="va">font_size</span> <span class="op">=</span> <span class="fl">8</span>, <span class="va">caption_label</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Var2</span>, y <span class="op">=</span> <span class="va">Var1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-1"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="st">"white"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="cn">NULL</span>, y<span class="op">=</span><span class="cn">NULL</span>, title<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>limits<span class="op">=</span><span class="va">rev</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="va">caption_label</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">font_size</span>, vjust<span class="op">=</span><span class="fl">0.5</span>, angle <span class="op">=</span> <span class="fl">90</span>, hjust<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>          axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">font_size</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>          plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>, hjust<span class="op">=</span><span class="fl">0.5</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">marrangeGrob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">plot_mat</span><span class="op">(</span><span class="va">incside</span><span class="op">$</span><span class="va">agg_mat</span>, caption_label <span class="op">=</span> <span class="st">"Income hierarchy"</span><span class="op">)</span>,</span>
<span>                  <span class="fu">plot_mat</span><span class="op">(</span><span class="va">outside</span><span class="op">$</span><span class="va">agg_mat</span>, caption_label <span class="op">=</span> <span class="st">"Output hierarchy"</span><span class="op">)</span>, </span>
<span>                  <span class="fu">plot_mat</span><span class="op">(</span><span class="va">expside</span><span class="op">$</span><span class="va">agg_mat</span>, caption_label <span class="op">=</span> <span class="st">"Expenditure hierarchy"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             top <span class="op">=</span> <span class="cn">NULL</span>, layout_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Dataset-vndata-and-itagdp_files/figure-html/plot-itagdp-1.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>The complete <span class="math inline">\((9 \times 21)\)</span> zero constraints matrix encompassing output, expenditure and income sides is represented in the following figure.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GDP[O]"</span>, <span class="st">"GDP[I]"</span>, <span class="st">"GDP[E]"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span> </span>
<span><span class="fu">plot_mat</span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Dataset-vndata-and-itagdp_files/figure-html/gdpconsmat-1.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>A linear combination matrix for a general linearly constrained multiple time series may be construct <span class="citation" data-cites="Girolimetto2023-ft">(<a href="#ref-Girolimetto2023-ft" role="doc-biblioref">Girolimetto &amp; Di Fonzo, 2023</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcmat.html">lcmat</a></span><span class="op">(</span><span class="va">gdpconsmat</span><span class="op">)</span> </span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">obj</span><span class="op">$</span><span class="va">agg_mat</span></span>
<span><span class="fu">plot_mat</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>, caption_label <span class="op">=</span> <span class="st">"Income, Output and Expenditure linear combination matrix"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Dataset-vndata-and-itagdp_files/figure-html/lcmat-gdp-1.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-DiFonzo2024-ijf" class="csl-entry" role="listitem">
Di Fonzo, T., &amp; Girolimetto, D. (2024). Forecast combination-based forecast reconciliation: Insights and extensions. <em>International Journal of Forecasting</em>, <em>40</em>(2), 490–514. <a href="https://doi.org/10.1016/j.ijforecast.2022.07.001" class="external-link">https://doi.org/10.1016/j.ijforecast.2022.07.001</a>
</div>
<div id="ref-Girolimetto2023-jm" class="csl-entry" role="listitem">
Girolimetto, D., Athanasopoulos, G., Di Fonzo, T., &amp; Hyndman, R. J. (2024). Cross-temporal probabilistic forecast reconciliation: Methodological and practical issues. <em>International Journal of Forecasting</em>, <em>40</em>(3), 1134–1151. <a href="https://doi.org/10.1016/j.ijforecast.2023.10.003" class="external-link">https://doi.org/10.1016/j.ijforecast.2023.10.003</a>
</div>
<div id="ref-Girolimetto2023-ft" class="csl-entry" role="listitem">
Girolimetto, D., &amp; Di Fonzo, T. (2023). Point and probabilistic forecast reconciliation for general linearly constrained multiple time series. <em>Statistical Methods &amp; Applications</em>. <a href="https://doi.org/10.1007/s10260-023-00738-6" class="external-link">https://doi.org/10.1007/s10260-023-00738-6</a>
</div>
<div id="ref-Wickramasuriya2019" class="csl-entry" role="listitem">
Wickramasuriya, S. L., Athanasopoulos, G., &amp; Hyndman, R. J. (2018). Optimal Forecast Reconciliation for Hierarchical and Grouped Time Series Through Trace Minimization. <em>Journal of the American Statistical Association</em>, <em>114</em>(526), 804–819. <a href="https://doi.org/10.1080/01621459.2018.1448825" class="external-link">https://doi.org/10.1080/01621459.2018.1448825</a>
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniele Girolimetto, Tommaso Di Fonzo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
